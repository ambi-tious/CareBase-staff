# 職員選択画面設計書

Issue: [#139 （認証）｜職員選択](https://github.com/ambi-tious/CareBase-staff/issues/139)

## 概要

CareBase-staffアプリケーションの職員選択画面設計書です。
グループとチームを選択してチームにひもづく職員を表示し、選択した職員でログインする機能を提供します。
ログイン画面での認証成功後、または既存セッションからの職員変更時に使用されます。

### モックURL

https://carebase-staff.vercel.app/staff-selection

## 全体レイアウト

### 画面構成

1画面で完結する職員選択インターフェース：
- グループ選択エリア（複数グループがある場合のみ表示）
- チーム選択エリア（複数チームがある場合のみ表示）
- 職員選択エリア
- ログインボタン
- ログアウトボタン（戻るボタンの代わり）

### 画面項目

| 項目名 | コンポーネント | 必須 | 表示条件 | 初期値 | 備考 |
| --- | --- | --- | --- | --- | --- |
| ページタイトル | CardTitle | - | 常時 | スタッフ選択 | カード内ヘッダー |
| ログアウトボタン | Button | - | 常時 | ログアウト | 右上に配置、赤色スタイル |
| エラーメッセージ | ErrorAlert | - | エラー時 | - | 選択エラー時に表示 |
| グループ選択エリア | GroupSelector | ◯ | 複数グループ存在時 | - | グリッドレイアウト |
| 選択済みグループ表示 | 情報表示エリア | - | 単一グループ時 | 自動選択されたグループ | 青色背景で表示 |
| チーム選択エリア | TeamSelector | ◯ | 複数チーム存在時 | - | グリッドレイアウト |
| 選択済みチーム表示 | 情報表示エリア | - | 単一チーム時 | 自動選択されたチーム | 緑色背景で表示 |
| 職員選択エリア | StaffSelector | ◯ | チーム選択後 | - | グリッドレイアウト |
| ログインボタン | Button | - | 職員選択後 | 選択したスタッフでログイン | 青色スタイル、中央配置 |

## 機能仕様

### アクション

| 項目名 | 処理内容 | 対象API | 遷移先画面 |
| --- | --- | --- | --- |
| グループ選択 | グループを選択し、チーム一覧を更新 | - | 同一画面（チーム選択エリア表示） |
| チーム選択 | チームを選択し、職員一覧を更新 | - | 同一画面（職員選択エリア表示） |
| 職員選択 | 職員を選択し、ログインボタンを表示 | - | 同一画面（ログインボタン表示） |
| ログインボタン | 選択した職員でログイン処理を実行 | `/api/v1/auth/staff/login` | ダッシュボード画面 (`/`) |
| ログアウトボタン | 認証情報をクリアしてログアウト | - | ログイン画面 (`/login`) |

### 入力チェック

| 項目名 | イベント | チェック内容 | エラーメッセージ |
| --- | --- | --- | --- |
| グループ選択 | click | 必須選択チェック | グループを選択してください |
| チーム選択 | click | 必須選択チェック | チームを選択してください |
| 職員選択 | click | 必須選択チェック | スタッフを選択してください |
| 職員選択 | click | 有効性チェック | 有効なスタッフを選択してください |
| ログインボタン | click | 全項目選択チェック | グループ、チーム、スタッフをすべて選択してください |

### バリデーション仕様

#### 自動選択ロジック

- **グループ自動選択**: 組織に1つのグループしかない場合、自動的に選択状態にする
- **チーム自動選択**: 選択されたグループに1つのチームしかない場合、自動的に選択状態にする
- **職員確認表示**: 要望により職員確認表示は実装しない

#### 表示制御

- グループが1つの場合: グループ選択エリアを非表示にし、選択済み表示エリアを表示
- チームが1つの場合: チーム選択エリアを非表示にし、選択済み表示エリアを表示
- 職員選択後: ログインボタンを表示し、スムーズスクロールで移動

#### エラーハンドリング

- 無効な職員選択時のエラー表示
- 必須項目未選択時のエラー表示
- LocalStorage操作エラーのコンソール出力

## データ構造

### Group（グループ）

```typescript
interface Group {
  id: string;
  name: string;        // 例: "介護フロア A", "管理部門"
  description: string; // 例: "1階 介護フロア", "施設管理・事務"
  icon: IconName;      // Lucideアイコン名
  teams: Team[];       // 所属チーム一覧
}
```

### Team（チーム）

```typescript
interface Team {
  id: string;
  name: string;        // 例: "朝番チーム", "日勤チーム"
  description: string; // 例: "早朝・午前担当", "日中担当"
  icon: IconName;      // Lucideアイコン名
  staff: Staff[];      // 所属職員一覧
}
```

### Staff（職員）

```typescript
interface Staff {
  id: string;
  name: string;        // 職員名
  furigana: string;    // ふりがな
  role: string;        // 役職（例: "介護職員", "看護師"）
  employeeId: string;  // 職員ID
  avatar?: string;     // アバター画像URL（オプション）
  isActive: boolean;   // 有効フラグ
}
```

## UI/UX仕様

### レスポンシブデザイン

- **グループ選択**: 1列（モバイル）→ 2列（タブレット以上）
- **チーム選択**: 1列（モバイル）→ 2列（タブレット以上）
- **職員選択**: 1列（モバイル）→ 2列（タブレット）→ 3列（デスクトップ）

### カラーテーマ

- **選択状態**: `ring-2 ring-carebase-blue bg-carebase-blue text-white`
- **ホバー状態**: `hover:ring-1 hover:ring-carebase-blue-light`
- **自動選択表示**: 
  - グループ: `bg-blue-50 border-blue-200`
  - チーム: `bg-green-50 border-green-200`
- **ログアウトボタン**: `text-red-600 border-red-300 hover:bg-red-50`

### アニメーション

- **スムーズスクロール**: 選択後に次のエリアへ自動スクロール
- **トランジション**: 選択状態変更時のカラー変更アニメーション
- **ローディング**: 職員選択処理中の500ms待機

## 参考資料

- [ログイン画面設計書](../login/README.md)
- [Issue #139: （認証）｜職員選択](https://github.com/ambi-tious/CareBase-staff/issues/139)
- [画面一覧](../../../docs/screen-list.md#認証関連)
- [職員選択画面実装](./page.tsx)
- [StaffSelectionScreen コンポーネント](../../../components/3_organisms/auth/staff-selection-screen.tsx)

# 介護記録一覧画面設計書

- 画面名: `介護記録一覧`
- パス: `/care-records`
- URL: https://carebase-staff.vercel.app/care-records

## 概要

介護記録一覧画面設計書です。
介護現場での日々の記録を一覧表示し、検索・フィルタリング機能、詳細表示、新規作成機能を提供します。
記録種別、重要度、ステータス管理により効率的な記録管理を実現します。

## 全体レイアウト

### 画面構成

介護記録管理のメイン画面として以下の要素で構成：

- ページヘッダー（統計情報）
- アクションボタン（新規作成）
- 検索・フィルター機能
- 介護記録一覧テーブル
- ページネーション
- 空状態表示

### 画面項目

| 項目名               | コンポーネント      | 必須 | 表示条件     | 初期値                       | 備考                                   |
| -------------------- | ------------------- | ---- | ------------ | ---------------------------- | -------------------------------------- |
| 統計情報             | 情報表示エリア      | -    | 常時         | 総件数・表示中件数・ページ数 | リアルタイム更新                       |
| 検索バー             | CareRecordSearchBar | -    | 常時         | 空文字                       | タイトル・内容・利用者名・職員名で検索 |
| メインメニューボタン | Button              | -    | 常時         | メインメニュー               | アウトライン、ArrowLeft アイコン       |
| 新規作成ボタン       | Button              | -    | 常時         | 新規記録作成                 | 青色スタイル、PlusCircle アイコン      |
| フィルターボタン     | Button              | -    | 常時         | フィルター                   | アウトライン、Filter アイコン          |
| 記録種別フィルター   | Select              | -    | フィルター時 | すべて                       | 食事/入浴/服薬等での絞り込み           |
| 重要度フィルター     | Select              | -    | フィルター時 | すべて                       | 高/中/低での絞り込み                   |
| ステータスフィルター | Select              | -    | フィルター時 | すべて                       | 下書き/完了/確認済みでの絞り込み       |
| 日付範囲フィルター   | DateInput           | -    | フィルター時 | -                            | 開始日・終了日での絞り込み             |
| リセットボタン       | Button              | -    | フィルター時 | リセット                     | フィルター条件をクリア                 |
| 記録テーブル         | Table               | -    | データあり時 | -                            | 介護記録情報の一覧表示                 |
| ページネーション     | Pagination          | -    | データあり時 | -                            | 20件/ページ、表示件数変更可能          |
| 空状態表示           | EmptyState          | -    | データなし時 | -                            | FileText アイコン付きメッセージ        |

## 機能仕様

### アクション

| 項目名               | 処理内容                               | 対象API | 遷移先画面                             |
| -------------------- | -------------------------------------- | ------- | -------------------------------------- |
| 検索実行             | タイトル・内容・利用者名・職員名で検索 | -       | 同一画面（結果更新）                   |
| 記録種別フィルター   | 記録種別による絞り込み                 | -       | 同一画面（結果更新）                   |
| 重要度フィルター     | 重要度による絞り込み                   | -       | 同一画面（結果更新）                   |
| ステータスフィルター | ステータスによる絞り込み               | -       | 同一画面（結果更新）                   |
| 日付範囲フィルター   | 記録日時による絞り込み                 | -       | 同一画面（結果更新）                   |
| フィルターリセット   | 全フィルター条件をクリア               | -       | 同一画面（結果更新）                   |
| 新規記録作成         | 新規介護記録作成画面への遷移           | -       | 新規記録作成画面 (`/care-records/new`) |
| 記録詳細表示         | 選択した記録の詳細画面への遷移         | -       | 記録詳細画面 (`/care-records/{id}`)    |
| 利用者詳細表示       | 利用者名クリックで利用者詳細画面に遷移 | -       | 利用者詳細画面 (`/residents/{id}`)     |
| ページ変更           | ページネーションによるページ切り替え   | -       | 同一画面（ページ更新）                 |

### テーブル仕様

| 列名         | 幅   | 内容                       | ソート | 備考                   |
| ------------ | ---- | -------------------------- | ------ | ---------------------- |
| 記録ID       | 固定 | record.id                  | -      | フォント: monospace    |
| 利用者名     | 固定 | 利用者名                   | -      | User アイコン付き      |
| 記録日時     | 固定 | MM/dd HH:mm形式            | ○      | Clock アイコン付き     |
| 記録種別     | 固定 | カテゴリバッジ             | -      | 色分けバッジ表示       |
| タイトル概要 | 可変 | タイトル + 概要（50文字）  | -      | 2行表示                |
| 担当職員     | 固定 | 職員名                     | -      | 作成者情報             |
| 重要度       | 固定 | 高/中/低バッジ             | -      | 色分けバッジ表示       |
| ステータス   | 固定 | 下書き/完了/確認済みバッジ | -      | 色分けバッジ表示       |
| 操作         | 固定 | 詳細ボタン                 | -      | Eye アイコン付きボタン |

### ページネーション仕様

- **デフォルト表示件数**: 20件/ページ
- **表示件数選択**: 10件、20件、50件、100件から選択可能
- **ページ移動**: 最初/前/次/最後のページボタン
- **ページ番号表示**: 現在ページ周辺のページ番号を表示
- **表示範囲**: 「1-20 / 150件」形式で表示

### 入力チェック

| 項目名   | イベント | チェック内容              | エラーメッセージ                              |
| -------- | -------- | ------------------------- | --------------------------------------------- |
| 検索バー | input    | 文字数制限（100文字以内） | 検索キーワードは100文字以内で入力してください |
| 開始日   | change   | 日付形式チェック          | 有効な日付を入力してください                  |
| 終了日   | change   | 日付形式チェック          | 有効な日付を入力してください                  |
| 日付範囲 | change   | 開始日≤終了日チェック     | 終了日は開始日以降の日付を入力してください    |

### バリデーション仕様

#### 検索ロジック

- **部分一致検索**: タイトル・内容・利用者名・担当職員名で部分一致検索を実行
- **大文字小文字無視**: 検索時は大文字小文字を区別しない
- **リアルタイム検索**: 入力と同時に検索結果を更新
- **空文字処理**: 検索キーワードが空の場合は全件表示

#### 表示制御

- **ソート**: 記録日時の降順（新しい順）で表示
- **フィルター組み合わせ**: 複数フィルター条件のAND検索
- **ページネーション**: 大量データ時の分割表示
- **レスポンシブ**: モバイル・タブレット・デスクトップ対応

#### エラーハンドリング

- 検索結果0件時の適切なメッセージ表示
- API通信エラー時のフォールバック表示
- データ読み込み失敗時のエラー表示

## UI/UX仕様

### レスポンシブデザイン

- **テーブル**: 横スクロール対応（モバイル）→ 固定幅表示（デスクトップ）
- **アクションボタン**: 縦積み（モバイル）→ 横並び（タブレット以上）
- **検索・フィルター**: 縦積み（モバイル）→ 横並び（デスクトップ）
- **フィルター**: 折りたたみ表示（モバイル）→ 展開表示（デスクトップ）

### カラーテーマ

- **記録種別バッジ**:
  - 食事: `bg-orange-100 text-orange-700 border-orange-200`
  - 入浴: `bg-blue-100 text-blue-700 border-blue-200`
  - 服薬: `bg-purple-100 text-purple-700 border-purple-200`
  - 排泄: `bg-brown-100 text-brown-700 border-brown-200`
  - バイタル: `bg-red-100 text-red-700 border-red-200`
  - 運動: `bg-green-100 text-green-700 border-green-200`
  - コミュニケーション: `bg-indigo-100 text-indigo-700 border-indigo-200`
  - その他: `bg-gray-100 text-gray-700 border-gray-200`
- **重要度バッジ**:
  - 高: `bg-red-100 text-red-700 border-red-200`
  - 中: `bg-yellow-100 text-yellow-700 border-yellow-200`
  - 低: `bg-blue-100 text-blue-700 border-blue-200`
- **ステータスバッジ**:
  - 下書き: `bg-gray-100 text-gray-700 border-gray-200`
  - 完了: `bg-green-100 text-green-700 border-green-200`
  - 確認済み: `bg-blue-100 text-blue-700 border-blue-200`
- **新規作成ボタン**: `bg-carebase-blue hover:bg-carebase-blue-dark`

### アニメーション

- **テーブル行ホバー**: `hover:bg-gray-50 transition-colors`
- **ボタンホバー**: スムーズなカラートランジション
- **検索結果更新**: フェードイン・アウト効果
- **フィルター展開**: スムーズな開閉アニメーション

### アクセシビリティ

- **キーボードナビゲーション**: Tab キーでの操作対応
- **スクリーンリーダー**: 適切な aria-label 設定
- **コントラスト比**: WCAG 2.1 AA レベル準拠
- **フォーカス表示**: 明確なフォーカスインジケーター

## 技術仕様

### 使用コンポーネント

#### 1_atoms層

- **CategoryBadge**: 記録種別バッジ表示
- **PriorityBadge**: 重要度バッジ表示
- **StatusBadge**: ステータスバッジ表示

#### 2_molecules層

- **CareRecordSearchBar**: 検索バー
- **CareRecordFilters**: フィルター機能
- **CareRecordTableRow**: テーブル行
- **CareRecordPagination**: ページネーション

#### 3_organisms層

- **CareRecordList**: 介護記録一覧表示

### データ型定義

```typescript
interface CareRecord {
  id: string;
  residentId: string;
  residentName: string;
  category: CareRecordCategory;
  title: string;
  content: string;
  summary: string;
  recordedAt: string;
  createdAt: string;
  updatedAt: string;
  createdBy: string;
  createdByName: string;
  priority: CareRecordPriority;
  status: CareRecordStatus;
}
```

### API エンドポイント

| メソッド | エンドポイント          | 説明             |
| -------- | ----------------------- | ---------------- |
| GET      | `/v1/care-records`      | 介護記録一覧取得 |
| GET      | `/v1/care-records/{id}` | 介護記録詳細取得 |
| POST     | `/v1/care-records`      | 介護記録新規作成 |
| PUT      | `/v1/care-records/{id}` | 介護記録更新     |
| DELETE   | `/v1/care-records/{id}` | 介護記録削除     |

### 状態管理

- **ローカル状態**: 検索クエリ、フィルター条件、ページネーション状態
- **URL同期**: 検索・フィルター条件をURLパラメータで管理
- **エラー処理**: API通信エラー時のフォールバック

## 画面遷移仕様

### 遷移先URL一覧

| 遷移元               | 遷移先             | URL                             | パラメータ           |
| -------------------- | ------------------ | ------------------------------- | -------------------- |
| メインメニューボタン | メインメニュー画面 | `/`                             | なし                 |
| 新規記録作成ボタン   | 新規記録作成画面   | `/care-records/new`             | なし                 |
| 記録行クリック       | 記録詳細画面       | `/care-records/{recordId}`      | recordId: 記録ID     |
| 利用者名クリック     | 利用者詳細画面     | `/residents/{residentId}`       | residentId: 利用者ID |
| 詳細ボタンクリック   | 記録詳細画面       | `/care-records/{recordId}`      | recordId: 記録ID     |
| 編集ボタンクリック   | 記録編集画面       | `/care-records/{recordId}/edit` | recordId: 記録ID     |

### URLパラメータ仕様

#### 検索・フィルター条件

```
/care-records?query={検索キーワード}&category={記録種別}&priority={重要度}&status={ステータス}&dateFrom={開始日}&dateTo={終了日}&page={ページ番号}&limit={表示件数}
```

**パラメータ詳細:**

- `query`: 検索キーワード（文字列、任意）
- `category`: 記録種別（meal|bathing|medication|excretion|vital|exercise|communication|other、任意）
- `priority`: 重要度（high|medium|low、任意）
- `status`: ステータス（draft|completed|reviewed、任意）
- `dateFrom`: 開始日（YYYY-MM-DD形式、任意）
- `dateTo`: 終了日（YYYY-MM-DD形式、任意）
- `page`: ページ番号（数値、デフォルト: 1）
- `limit`: 表示件数（数値、デフォルト: 20）

#### 記録詳細画面

```
/care-records/{recordId}
```

**パラメータ詳細:**

- `recordId`: 記録ID（文字列、必須）

#### 記録編集画面

```
/care-records/{recordId}/edit
```

**パラメータ詳細:**

- `recordId`: 記録ID（文字列、必須）

## 参考資料

- [介護記録一覧画面実装](./page.tsx)
- [CareRecordList コンポーネント](../../../components/3_organisms/care-record/care-record-list.tsx)
- [CareRecordTableRow コンポーネント](../../../components/2_molecules/care-record/care-record-table-row.tsx)
- [Care Record Types](../../../types/care-record.ts)
- [画面一覧](../../../docs/screen-list.md#申し送り介護記録)
